<div style="background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba; padding: 15px; border-radius: 5px; margin-bottom: 20px;"> <strong>⚠️ Deprecation Notice:</strong> This component (<em>Map Reduce</em>) is no longer actively maintained. It remains accessible for historical reference but is not recommended for new development.  Please check out <a href="https://mahout.apache.org/quantum-computing-primer/" style="color: #0c5460; text-decoration: underline;">Qumat - Mahout's Quantum Computing Primer</a> for the latest innovations.</div>

<h1 id="wikipedia-xml-parser-and-naive-bayes-classifier-example">Wikipedia XML parser and Naive Bayes Classifier Example</h1>

<h2 id="introduction">Introduction</h2>
<p>Mahout has an <a href="https://github.com/apache/mahout/blob/master/examples/bin/classify-wikipedia.sh">example script</a> [1] which will download a recent XML dump of the (entire if desired) <a href="http://dumps.wikimedia.org/enwiki/latest/">English Wikipedia database</a>. After running the classification script, you can use the <a href="https://github.com/apache/mahout/blob/master/examples/bin/spark-document-classifier.mscala">document classification script</a> from the Mahout <a href="http://mahout.apache.org/users/sparkbindings/play-with-shell.html">spark-shell</a> to vectorize and classify text from outside of the training and testing corpus using a modle built on the Wikipedia dataset.</p>

<p>You can run this script to build and test a Naive Bayes classifier for option (1) 10 arbitrary countries or option (2) 2 countries (United States and United Kingdom).</p>

<h2 id="oververview">Oververview</h2>

<p>Tou run the example simply execute the <code class="language-plaintext highlighter-rouge">$MAHOUT_HOME/examples/bin/classify-wikipedia.sh</code> script.</p>

<p>By defult the script is set to run on a medium sized Wikipedia XML dump.  To run on the full set (the entire english Wikipedia) you can change the download by commenting out line 78, and uncommenting line 80  of <a href="https://github.com/apache/mahout/blob/master/examples/bin/classify-wikipedia.sh">classify-wikipedia.sh</a> [1]. However this is not recommended unless you have the resources to do so. <em>Be sure to clean your work directory when changing datasets- option (3).</em></p>

<p>The step by step process for Creating a Naive Bayes Classifier for the Wikipedia XML dump is very similar to that for <a href="http://mahout.apache.org/users/classification/twenty-newsgroups.html">creating a 20 Newsgroups Classifier</a> [4].  The only difference being that instead of running <code class="language-plaintext highlighter-rouge">$mahout seqdirectory</code> on the unzipped 20 Newsgroups file, you’ll run <code class="language-plaintext highlighter-rouge">$mahout seqwiki</code> on the unzipped Wikipedia xml dump.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mahout seqwiki 
</code></pre></div></div>

<p>The above command launches <code class="language-plaintext highlighter-rouge">WikipediaToSequenceFile.java</code> which accepts a text file of categories [3] and starts an MR job to parse the each document in the XML file.  This process will seek to extract documents with a wikipedia category tag which (exactly, if the <code class="language-plaintext highlighter-rouge">-exactMatchOnly</code> option is set) matches a line in the category file.  If no match is found and the <code class="language-plaintext highlighter-rouge">-all</code> option is set, the document will be dumped into an “unknown” category. The documents will then be written out as a <code class="language-plaintext highlighter-rouge">&lt;Text,Text&gt;</code> sequence file of the form (K:/category/document_title , V: document).</p>

<p>There are 3 different example category files available to in the /examples/src/test/resources
directory:  country.txt, country10.txt and country2.txt.  You can edit these categories to extract a different corpus from the Wikipedia dataset.</p>

<p>The CLI options for <code class="language-plaintext highlighter-rouge">seqwiki</code> are as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--input          (-i)         input pathname String
--output         (-o)         the output pathname String
--categories     (-c)         the file containing the Wikipedia categories
--exactMatchOnly (-e)         if set, then the Wikipedia category must match
                                exactly instead of simply containing the category string
--all            (-all)       if set select all categories
--removeLabels   (-rl)        if set, remove [[Category:labels]] from document text after extracting label.
</code></pre></div></div>

<p>After <code class="language-plaintext highlighter-rouge">seqwiki</code>, the script runs <code class="language-plaintext highlighter-rouge">seq2sparse</code>, <code class="language-plaintext highlighter-rouge">split</code>, <code class="language-plaintext highlighter-rouge">trainnb</code> and <code class="language-plaintext highlighter-rouge">testnb</code> as in the <a href="http://mahout.apache.org/users/classification/twenty-newsgroups.html">step by step 20newsgroups example</a>.  When all of the jobs have finished, a confusion matrix will be displayed.</p>

<p>#Resourcese</p>

<p>[1] <a href="https://github.com/apache/mahout/blob/master/examples/bin/classify-wikipedia.sh">classify-wikipedia.sh</a></p>

<p>[2] <a href="https://github.com/apache/mahout/blob/master/examples/bin/spark-document-classifier.mscala">Document classification script for the Mahout Spark Shell</a></p>

<p>[3] <a href="https://github.com/apache/mahout/blob/master/examples/src/test/resources/country10.txt">Example category file</a></p>

<p>[4] <a href="http://mahout.apache.org/users/classification/twenty-newsgroups.html">Step by step instructions for building a Naive Bayes classifier for 20newsgroups from the command line</a></p>

<p>[5] <a href="http://mahout.apache.org/users/classification/bayesian.html">Mahout MapReduce Naive Bayes</a></p>

<p>[6] <a href="http://mahout.apache.org/users/algorithms/spark-naive-bayes.html">Mahout Spark Naive Bayes</a></p>

<p>[7] <a href="http://mahout.apache.org/users/sparkbindings/home.html">Mahout Scala Spark and H2O Bindings</a></p>

