"use strict";(globalThis.webpackChunkmahout_website=globalThis.webpackChunkmahout_website||[]).push([[2744],{2142(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>d,toc:()=>t});const d=JSON.parse('{"id":"qdp/api","title":"API Reference - QDP","description":"Mahout QDP (Quantum Data Plane) provides GPU-accelerated quantum state encoding.","source":"@site/docs/qdp/api.md","sourceDirName":"qdp","slug":"/qdp/api","permalink":"/docs/qdp/api","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/mahout/tree/main/docs/docs/qdp/api.md","tags":[],"version":"current","frontMatter":{"title":"API Reference - QDP"},"sidebar":"docsSidebar","previous":{"title":"Core Concepts - QDP","permalink":"/docs/qdp/concepts"},"next":{"title":"Examples - QDP","permalink":"/docs/qdp/examples"}}');var s=i(4848),r=i(8453);const c={title:"API Reference - QDP"},l="API Reference",o={},t=[{value:"Module: <code>qumat.qdp</code>",id:"module-qumatqdp",level:2},{value:"Class: <code>QdpEngine</code>",id:"class-qdpengine",level:2},{value:"<code>QdpEngine(device_id=0, precision=&quot;float32&quot;)</code>",id:"qdpenginedevice_id0-precisionfloat32",level:3},{value:"<code>encode(data, num_qubits, encoding_method=&quot;amplitude&quot;) -&gt; QuantumTensor</code>",id:"encodedata-num_qubits-encoding_methodamplitude---quantumtensor",level:3},{value:"<code>encode_from_tensorflow(path, num_qubits, encoding_method=&quot;amplitude&quot;) -&gt; QuantumTensor</code>",id:"encode_from_tensorflowpath-num_qubits-encoding_methodamplitude---quantumtensor",level:3},{value:"Class: <code>QuantumTensor</code>",id:"class-quantumtensor",level:2},{value:"<code>__dlpack__(stream=None)</code>",id:"__dlpack__streamnone",level:3},{value:"<code>__dlpack_device__()</code>",id:"__dlpack_device__",level:3},{value:"Encoding Methods",id:"encoding-methods",level:2},{value:"<code>amplitude</code>",id:"amplitude",level:3},{value:"<code>angle</code>",id:"angle",level:3},{value:"<code>basis</code>",id:"basis",level:3},{value:"<code>iqp</code>",id:"iqp",level:3},{value:"<code>iqp-z</code>",id:"iqp-z",level:3},{value:"Supported File Formats",id:"supported-file-formats",level:2},{value:"Common Errors",id:"common-errors",level:2},{value:"Requirements &amp; Deprecation",id:"requirements--deprecation",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"api-reference",children:"API Reference"})}),"\n",(0,s.jsx)(n.p,{children:"Mahout QDP (Quantum Data Plane) provides GPU-accelerated quantum state encoding.\nIt writes classical data directly into GPU memory and returns a DLPack-compatible\nhandle for zero-copy integration with downstream frameworks."}),"\n",(0,s.jsxs)(n.h2,{id:"module-qumatqdp",children:["Module: ",(0,s.jsx)(n.code,{children:"qumat.qdp"})]}),"\n",(0,s.jsxs)(n.p,{children:["Prefer importing from ",(0,s.jsx)(n.code,{children:"qumat.qdp"}),"; the native extension is ",(0,s.jsx)(n.code,{children:"_qdp"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import qumat.qdp as qdp\n# or: from _qdp import QdpEngine, QuantumTensor\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"class-qdpengine",children:["Class: ",(0,s.jsx)(n.code,{children:"QdpEngine"})]}),"\n",(0,s.jsx)(n.h3,{id:"qdpenginedevice_id0-precisionfloat32",children:(0,s.jsx)(n.code,{children:'QdpEngine(device_id=0, precision="float32")'})}),"\n",(0,s.jsx)(n.p,{children:"Create a GPU encoder instance."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"device_id"})," (int): CUDA device ID, default ",(0,s.jsx)(n.code,{children:"0"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"precision"})," (str): ",(0,s.jsx)(n.code,{children:'"float32"'})," or ",(0,s.jsx)(n.code,{children:'"float64"'}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Raises"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"RuntimeError"}),": Initialization failure or unsupported precision."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"encodedata-num_qubits-encoding_methodamplitude---quantumtensor",children:(0,s.jsx)(n.code,{children:'encode(data, num_qubits, encoding_method="amplitude") -> QuantumTensor'})}),"\n",(0,s.jsx)(n.p,{children:"Encode classical input into a quantum state and return a DLPack tensor on GPU."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"data"}),": Supported inputs\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"list[float]"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"numpy.ndarray"})," (1D/2D, dtype=float64, C-contiguous)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"torch.Tensor"})," (CPU, float64, contiguous)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"str"})," / ",(0,s.jsx)(n.code,{children:"pathlib.Path"})," file path\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".parquet"}),", ",(0,s.jsx)(n.code,{children:".arrow"})," / ",(0,s.jsx)(n.code,{children:".feather"}),", ",(0,s.jsx)(n.code,{children:".npy"}),", ",(0,s.jsx)(n.code,{children:".pt"})," / ",(0,s.jsx)(n.code,{children:".pth"}),", ",(0,s.jsx)(n.code,{children:".pb"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"num_qubits"})," (int): Number of qubits, range 1\u201330."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"encoding_method"})," (str): ",(0,s.jsx)(n.code,{children:'"amplitude" | "angle" | "basis" | "iqp" | "iqp-z"'})," (lowercase)."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Returns"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"QuantumTensor"})," with 2D shape:\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["single sample: ",(0,s.jsx)(n.code,{children:"[1, 2^num_qubits]"})]}),"\n",(0,s.jsxs)(n.li,{children:["batch: ",(0,s.jsx)(n.code,{children:"[batch_size, 2^num_qubits]"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Notes"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Output dtype is ",(0,s.jsx)(n.code,{children:"complex64"})," (",(0,s.jsx)(n.code,{children:'precision="float32"'}),") or ",(0,s.jsx)(n.code,{children:"complex128"})," (",(0,s.jsx)(n.code,{children:'precision="float64"'}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["Parquet streaming currently supports ",(0,s.jsx)(n.code,{children:'"amplitude"'})," and ",(0,s.jsx)(n.code,{children:'"basis"'}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["PyTorch file inputs (",(0,s.jsx)(n.code,{children:".pt"}),", ",(0,s.jsx)(n.code,{children:".pth"}),") require building with the ",(0,s.jsx)(n.code,{children:"pytorch"})," feature."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Raises"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"RuntimeError"}),": Invalid inputs, shapes, dtypes, or unsupported formats."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"encode_from_tensorflowpath-num_qubits-encoding_methodamplitude---quantumtensor",children:(0,s.jsx)(n.code,{children:'encode_from_tensorflow(path, num_qubits, encoding_method="amplitude") -> QuantumTensor'})}),"\n",(0,s.jsxs)(n.p,{children:["Encode directly from a TensorFlow TensorProto file (",(0,s.jsx)(n.code,{children:".pb"}),")."]}),"\n",(0,s.jsxs)(n.h2,{id:"class-quantumtensor",children:["Class: ",(0,s.jsx)(n.code,{children:"QuantumTensor"})]}),"\n",(0,s.jsx)(n.p,{children:"DLPack wrapper for GPU-resident quantum states."}),"\n",(0,s.jsx)(n.h3,{id:"__dlpack__streamnone",children:(0,s.jsx)(n.code,{children:"__dlpack__(stream=None)"})}),"\n",(0,s.jsx)(n.p,{children:"Return a DLPack PyCapsule. This can be consumed only once."}),"\n",(0,s.jsx)(n.h3,{id:"__dlpack_device__",children:(0,s.jsx)(n.code,{children:"__dlpack_device__()"})}),"\n",(0,s.jsxs)(n.p,{children:["Return ",(0,s.jsx)(n.code,{children:"(device_type, device_id)"}),"; CUDA devices report ",(0,s.jsx)(n.code,{children:"(2, gpu_id)"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Ownership & Lifetime"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"If not consumed, memory is freed when the object is dropped."}),"\n",(0,s.jsx)(n.li,{children:"If consumed, ownership transfers to the consumer (e.g., PyTorch)."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"encoding-methods",children:"Encoding Methods"}),"\n",(0,s.jsx)(n.h3,{id:"amplitude",children:(0,s.jsx)(n.code,{children:"amplitude"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Input length ",(0,s.jsx)(n.code,{children:"<= 2^num_qubits"}),"; remaining entries are zero-padded."]}),"\n",(0,s.jsx)(n.li,{children:"L2 normalization is applied."}),"\n",(0,s.jsx)(n.li,{children:"Zero vectors / NaN / Inf raise errors."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"angle",children:(0,s.jsx)(n.code,{children:"angle"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Each sample must provide exactly ",(0,s.jsx)(n.code,{children:"num_qubits"})," angles."]}),"\n",(0,s.jsx)(n.li,{children:"NaN / Inf raise errors."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"basis",children:(0,s.jsx)(n.code,{children:"basis"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Each sample provides one integer index in ",(0,s.jsx)(n.code,{children:"[0, 2^num_qubits)"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"iqp",children:(0,s.jsx)(n.code,{children:"iqp"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Expects ",(0,s.jsx)(n.code,{children:"n + n*(n-1)/2"})," parameters for ",(0,s.jsx)(n.code,{children:"n = num_qubits"})," (Z + ZZ terms)."]}),"\n",(0,s.jsx)(n.li,{children:"All parameters must be finite (no NaN/Inf)."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"iqp-z",children:(0,s.jsx)(n.code,{children:"iqp-z"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Expects ",(0,s.jsx)(n.code,{children:"n"})," parameters for ",(0,s.jsx)(n.code,{children:"n = num_qubits"})," (Z terms only)."]}),"\n",(0,s.jsx)(n.li,{children:"All parameters must be finite (no NaN/Inf)."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"supported-file-formats",children:"Supported File Formats"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Parquet"}),": ",(0,s.jsx)(n.code,{children:".parquet"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Arrow IPC"}),": ",(0,s.jsx)(n.code,{children:".arrow"}),", ",(0,s.jsx)(n.code,{children:".feather"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"NumPy"}),": ",(0,s.jsx)(n.code,{children:".npy"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"PyTorch"}),": ",(0,s.jsx)(n.code,{children:".pt"}),", ",(0,s.jsx)(n.code,{children:".pth"})," (requires ",(0,s.jsx)(n.code,{children:"pytorch"})," feature)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TensorFlow"}),": ",(0,s.jsx)(n.code,{children:".pb"})," (TensorProto)"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"common-errors",children:"Common Errors"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"num_qubits"})," out of range."]}),"\n",(0,s.jsxs)(n.li,{children:["Input length exceeds ",(0,s.jsx)(n.code,{children:"2^num_qubits"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Non-",(0,s.jsx)(n.code,{children:"float64"})," NumPy/Torch inputs."]}),"\n",(0,s.jsx)(n.li,{children:"Torch tensors not on CPU or not contiguous."}),"\n",(0,s.jsx)(n.li,{children:"DLPack capsule consumed more than once."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"requirements--deprecation",children:"Requirements & Deprecation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Linux with an NVIDIA GPU (CUDA)."}),"\n",(0,s.jsx)(n.li,{children:"CUDA driver/toolkit installed."}),"\n",(0,s.jsxs)(n.li,{children:["Python 3.10\u20133.12 (",(0,s.jsx)(n.code,{children:"requires-python >=3.10,<3.13"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"qumat"})," installed (the QDP native extension ships as ",(0,s.jsx)(n.code,{children:"qumat-qdp"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["Optional: ",(0,s.jsx)(n.code,{children:"torch"})," for DLPack integration, ",(0,s.jsx)(n.code,{children:"numpy"})," for NumPy inputs."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"No deprecations are planned for the initial PoC."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453(e,n,i){i.d(n,{R:()=>c,x:()=>l});var d=i(6540);const s={},r=d.createContext(s);function c(e){const n=d.useContext(r);return d.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),d.createElement(r.Provider,{value:n},e.children)}}}]);