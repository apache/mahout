<!DOCTYPE html>
<html lang=" en ">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
    Expectation Maximization
    
  </title>

  <meta name="description" content="Distributed Linear Algebra">

  <link rel="stylesheet" href="/assets/css/main.css">

  <!-- Font Awesome -->
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Maven+Pro:400,500" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,700,700i" rel="stylesheet">

  <link rel="canonical" href="http://mahout.apache.org//users/clustering/expectation-maximization.html">
  <link rel="alternate" type="application/rss+xml" title="Apache Mahout" href="/%20/feed.xml">


</head>


<body>

  <nav class="navbar navbar-expand-lg navbar-light bg-light navbar-mahout">

    <div class="container">

        <a class="navbar-brand" href="/">
          <img src="/assets/mahout-logo-blue.svg" alt="">
        </a>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            <ul class="navbar-nav ml-auto">

                <!-- Download -->
                <li class="nav-item">
                    <a class="nav-link" href="/downloads/">Download</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/docs/0.13.1-SNAPSHOT/index.html">Overview</a>
                </li>

                <!-- Developers -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Developers</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item" href="/developers/developer-resources.html">Developer Resources</a>
                        <a class="dropdown-item" href="/developers/buildingmahout/">Building Mahout from Source</a>
                        <a class="dropdown-item" href="/developers/issue-tracker/">Issues Tracking (JIRA)</a>
                        <!-- <a class="dropdown-item" href="/developers/patch-check-list/">Patch Check List</a> going to github template -->
                        <!-- <a class="dropdown-item" href="/developers/reference/">References</a> a lot of overlap with books, talks, etc. page -->
                        <a class="dropdown-item" href="/developers/release-notes/">Release Notes</a>
                        <!-- <a class="dropdown-item" href="/developers/thirdparty-dependencies/">Third Party Dependencies</a> is our site the reasonable place for this? -->
                        <!-- <a class="dropdown-item" href="/developers/version-control/">Version Control</a> -->
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">How To's</h6>
                        <a class="dropdown-item" href="/developers/how-to-contribute/">How to Contribute</a>
                        <a class="dropdown-item" href="/developers/githubPRs/">Github PRs</a>
                        <a class="dropdown-item" href="/developers/how-to-become-a-committer/">How to Become a Committer</a>
                        <a class="dropdown-item" href="/developers/how-to-release/">How to Release</a>
                        <a class="dropdown-item" href="/developers/how-to-update-the-website/">How to Update the Website</a>
                    </div>
                </li>

                <!-- Docs -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Docs</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <h6 class="dropdown-header">Release</h6>
                        <a class="dropdown-item" href="/docs/0.13.0">0.13.0</a>
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">Latest Snapshot (Development)</h6>
                        <a class="dropdown-item" href="/docs/latest">0.13.1-SNAPSHOT</a>
                    </div>
                </li>

                <!-- Community -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Community</a>
                    <div class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="/community/history/">History of the Apache Mahout Project</a>
                        <a class="dropdown-item" href="/community/blogs/">Blog Posts About Mahout</a>
                        <a class="dropdown-item" href="/community/recent-upcoming-talks/">Recent and Upcoming Talks</a>
                        <!-- <a class="dropdown-item" href="/community/books-tutorials-and-talks/">Books Tutorials and Talks</a> -->
                        <a class="dropdown-item" href="/community/buildingmahout/">Building Mahout</a>
                        <!-- <a class="dropdown-item" href="/community/faq/">FAQ</a> needs a lot of updating -->
                        <a class="dropdown-item" href="/community/gsoc/">GSoC</a>
                        <!-- Is OK- updated Map/Reduce verbage to reflect Samsara -->
                        <!-- <a class="dropdown-item" href="/community/mahout-benchmarks/">Mahout Benchmarks</a> These are old, Keep them? -->
                        <!-- <a class="dropdown-item" href="/community/mahout-wiki/">Mahout Wiki</a> at very least needs links cleanedup - do we still want this even?-->
                        <a class="dropdown-item" href="/community/mailing-lists/">Mailing Lists</a>
                        <!-- Clean and pretty -->
                        <!-- <a class="dropdown-item" href="/community/powered-by-mahout/">Powered By Mahout</a> needs update -->
                        <a class="dropdown-item" href="/community/privacy-policy/">Privacy Policy</a>
                        <!-- <a class="dropdown-item" href="/community/professional-support/">Professional Support</a> update if we even want to keep -->
                        <a class="dropdown-item" href="/community/who-we-are/">Who We Are</a>
                        <!-- nikolai needs to add himself -->
                    </div>
                </li>

                <!-- GitHub -->
                <li class="nav-item">
                    <a class="nav-link" href="http://github.com/apache/mahout"><i class="fa fa-github"></i></a>
                </li>

            </ul>

            <!-- <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form> -->

        </div>

    </div>

</nav>


  <p><a name="ExpectationMaximization-ExpectationMaximization"></a></p>
<h1 id="expectation-maximization">Expectation Maximization</h1>

<p>The principle of EM can be applied to several learning settings, but is
most commonly associated with clustering. The main principle of the
algorithm is comparable to k-Means. Yet in contrast to hard cluster
assignments, each object is given some probability to belong to a cluster.
Accordingly cluster centers are recomputed based on the average of all
objects weighted by their probability of belonging to the cluster at hand.</p>

<p><a name="ExpectationMaximization-Canopy-modifiedEM"></a></p>
<h2 id="canopy-modified-em">Canopy-modified EM</h2>

<p>One can also use the canopies idea to speed up prototypebased clustering
methods like K-means and Expectation-Maximization (EM). In general, neither
K-means nor EMspecify how many clusters to use. The canopies technique does
not help this choice.</p>

<p>Prototypes (our estimates of the cluster centroids) are associated with the
canopies that contain them, and the prototypes are only influenced by data
that are inside their associated canopies. After creating the canopies, we
decide how many prototypes will be created for each canopy. This could be
done, for example, using the number of data points in a canopy and AIC or
BIC where points that occur in more than one canopy are counted
fractionally. Then we place prototypesinto each canopy. This initial
placement can be random, as long as it is within the canopy in question, as
determined by the inexpensive distance metric.</p>

<p>Then, instead of calculating the distance from each prototype to every
point (as is traditional, a O(nk) operation), theE-step instead calculates
the distance from each prototype to a much smaller number of points. For
each prototype, we find the canopies that contain it (using the cheap
distance metric), and only calculate distances (using the expensive
distance metric) from that prototype to points within those canopies.</p>

<p>Note that by this procedure prototypes may move across canopy boundaries
when canopies overlap. Prototypes may move to cover the data in the
overlapping region, and then move entirely into another canopy in order to
cover data there.</p>

<p>The canopy-modified EM algorithm behaves very similarly to traditional EM,
with the slight difference that points outside the canopy have no influence
on points in the canopy, rather than a minute influence. If the canopy
property holds, and points in the same cluster fall in the same canopy,
then the canopy-modified EM will almost always converge to the same maximum
in likelihood as the traditional EM. In fact, the difference in each
iterative step (apart from the enormous computational savings of computing
fewer terms) will be negligible since points outside the canopy will have
exponentially small influence.</p>

<p><a name="ExpectationMaximization-StrategyforParallelization"></a></p>
<h2 id="strategy-for-parallelization">Strategy for Parallelization</h2>

<p><a name="ExpectationMaximization-Map/ReduceImplementation"></a></p>
<h2 id="mapreduce-implementation">Map/Reduce Implementation</h2>



  <footer class="footer bg-light">
    <div class="container text-center small">
        Copyright &copy; 2014-2017 The Apache Software Foundation, Licensed under the Apache License, Version 2.0.
    </div>
</footer>

  <script src="/assets/vendor/jquery/jquery-slim.min.js"></script>
  <script src="/assets/vendor/popper/popper.min.js"></script>
  <script src="/assets/vendor/bootstrap/js/bootstrap.min.js"></script>
  <script src="/assets/header.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

</body>

</html>
