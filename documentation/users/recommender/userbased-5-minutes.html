<!DOCTYPE html>
<html lang=" en ">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
    User Based Recommender in 5 Minutes
    
  </title>

  <meta name="description" content="Distributed Linear Algebra">

  <link rel="stylesheet" href="/assets/css/main.css">

  <!-- Font Awesome -->
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Maven+Pro:400,500" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,700,700i" rel="stylesheet">

  <link rel="canonical" href="http://mahout.apache.org//documentation/users/recommender/userbased-5-minutes.html">
  <link rel="alternate" type="application/rss+xml" title="Apache Mahout" href="/feed.xml">


</head>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-98314020-1', 'auto');
  ga('send', 'pageview');
</script>

<body>

  <nav class="navbar navbar-expand-lg navbar-light bg-light navbar-mahout">

    <div class="container">

        <a class="navbar-brand" href="/">
          <img src="/assets/mahout-logo-blue.svg" alt="">
        </a>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            <ul class="navbar-nav ml-auto">

                <!-- About -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle"
                       href="" id="navbarDropdownMenuLink-about"
                       data-toggle="dropdown"
                       aria-haspopup="true"
                       aria-expanded="false">About</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item"
                           href="https://www.apache.org/foundation/how-it-works.html">Overview of the Apache Software Foundation</a>
                        <a class="dropdown-item"
                           href="/about/distributed-matrix-math.html">Overview of Distributed Matrix Math</a>
                        <a class="dropdown-item"
                           href="/about/how-to-contribute.html">How to Contribute</a>
                    </div>
                </li>

                <!-- Documentation -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle"
                       href="" id="navbarDropdownMenuLink-docs"
                       data-toggle="dropdown"
                       aria-haspopup="true"
                       aria-expanded="false">Documentation</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item"
                           href="/papers.html">Papers</a>
                        <a class="dropdown-item"
                           href="/documentation/users">User Guide</a>
                        <a class="dropdown-item"
                           href="/documentation/developers">Developer Guide</a>
                        <a class="dropdown-item"
                           href="/docs/0.13.0/api/docs/">API Reference</a>
                        <a class="dropdown-item"
                           href="/documentation/tutorials">Tutorials and Examples</a>
                    </div>
                </li>

                <!-- Download -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle"
                       href="" id="navbarDropdownMenuLink-download"
                       data-toggle="dropdown"
                       aria-haspopup="true"
                       aria-expanded="false">Download</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item"
                           href="/download/downloads/html">Latest Release</a>
                        <a class="dropdown-item"
                           href="https://github.com/apache/mahout/">Github Repository</a>
                        <a class="dropdown-item"
                           href="/download/quickstart">Quickstart</a>
                    </div>
                </li>

                <!-- Community -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle"
                       href="" id="navbarDropdownMenuLink-community"
                       data-toggle="dropdown"
                       aria-haspopup="true"
                       aria-expanded="false">Community</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">

                        <a class="dropdown-item"
                           href="/community/">Overview</a>
                        <a class="dropdown-item"
                           href="/community/who-we-are.html">Who We Are</a>
                        <a class="dropdown-item"
                           href="/community/mailing-lists.html">Mailing Lists</a>
                        <a class="dropdown-item"
                           href="https://issues.apache.org/jira/browse/MAHOUT">Issue Tracker</a>
                        <a class="dropdown-item"
                           href="/documentation/developers/">Developer Documentation</a>
                        <a class="dropdown-item"
                           href="/community/coc.html">Code of Conduct</a>
                        <a class="dropdown-item"
                           href="/404.html">Partners and Supporters</a>
<!--                        Maybe make a new page that merges professional support and powered-by-mahout?-->
                    </div>
                </li>

                <!-- News and Events -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle"
                       href="" id="navbarDropdownMenuLink-news-events"
                       data-toggle="dropdown"
                       aria-haspopup="true"
                       aria-expanded="false">News and Events</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item"
                           href="/news-and-events/news.html">Latest Project News</a>
                        <a class="dropdown-item"
                           href="/news-and-events/events.html">Upcoming Events</a>
                        <a class="dropdown-item"
                           href="/news-and-events/announcements.html">Announcements</a>
                    </div>
                </li>


                <!-- GitHub -->
                <li class="nav-item">
                    <a class="nav-link" href="http://github.com/apache/mahout"><i class="fa fa-github"></i></a>
                </li>

            </ul>

            <!-- <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form> -->

        </div>

    </div>

</nav>


  <h1 id="creating-a-user-based-recommender-in-5-minutes">Creating a User-Based Recommender in 5 minutes</h1>

<p>##Prerequisites</p>

<p>Create a java project in your favorite IDE and make sure mahout is on the classpath. The easiest way to accomplish this is by importing it via maven as described on the <a href="/users/basics/quickstart.html">Quickstart</a> page.</p>

<h2 id="dataset">Dataset</h2>

<p>Mahout’s recommenders expect interactions between users and items as input. The easiest way to supply such data to Mahout is in the form of a textfile, where every line has the format <em>userID,itemID,value</em>. Here <em>userID</em> and <em>itemID</em> refer to a particular user and a particular item, and <em>value</em> denotes the strength of the interaction (e.g. the rating given to a movie).</p>

<p>In this example, we’ll use some made up data for simplicity. Create a file called “dataset.csv” and copy the following example interactions into the file.</p>

<pre>
1,10,1.0
1,11,2.0
1,12,5.0
1,13,5.0
1,14,5.0
1,15,4.0
1,16,5.0
1,17,1.0
1,18,5.0
2,10,1.0
2,11,2.0
2,15,5.0
2,16,4.5
2,17,1.0
2,18,5.0
3,11,2.5
3,12,4.5
3,13,4.0
3,14,3.0
3,15,3.5
3,16,4.5
3,17,4.0
3,18,5.0
4,10,5.0
4,11,5.0
4,12,5.0
4,13,0.0
4,14,2.0
4,15,3.0
4,16,1.0
4,17,4.0
4,18,1.0
</pre>

<h2 id="creating-a-user-based-recommender">Creating a user-based recommender</h2>

<p>Create a class called <em>SampleRecommender</em> with a main method.</p>

<p>The first thing we have to do is load the data from the file. Mahout’s recommenders use an interface called <em>DataModel</em> to handle interaction data. You can load our made up interactions like this:</p>

<pre>
DataModel model = new FileDataModel(new File("/path/to/dataset.csv"));
</pre>

<p>In this example, we want to create a user-based recommender. The idea behind this approach is that when we want to compute recommendations for a particular users, we look for other users with a similar taste and pick the recommendations from their items. For finding similar users, we have to compare their interactions. There are several methods for doing this. One popular method is to compute the <a href="https://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient">correlation coefficient</a> between their interactions. In Mahout, you use this method as follows:</p>

<pre>
UserSimilarity similarity = new PearsonCorrelationSimilarity(model);
</pre>

<p>The next thing we have to do is to define which similar users we want to leverage for the recommender. For the sake of simplicity, we’ll use all that have a similarity greater than <em>0.1</em>. This is implemented via a <em>ThresholdUserNeighborhood</em>:</p>

<pre>UserNeighborhood neighborhood = new ThresholdUserNeighborhood(0.1, similarity, model);</pre>

<p>Now we have all the pieces to create our recommender:</p>

<pre>
UserBasedRecommender recommender = new GenericUserBasedRecommender(model, neighborhood, similarity);
</pre>

<p>We can easily ask the recommender for recommendations now. If we wanted to get three items recommended for the user with <em>userID</em> 2, we would do it like this:</p>

<pre>
List<RecommendedItem> recommendations = recommender.recommend(2, 3);
for (RecommendedItem recommendation : recommendations) {
  System.out.println(recommendation);
}
&lt;/pre&gt;


Congratulations, you have built your first recommender!


## Evaluation

You might ask yourself, how to make sure that your recommender returns good results. Unfortunately, the only way to be really sure about the quality is by doing an A/B test with real users in a live system.

We can however try to get a feel of the quality, by statistical offline evaluation. Just keep in mind that this does not replace a test with real users!

One way to check whether the recommender returns good results is by doing a **hold-out** test. We partition our dataset into two sets: a trainingset consisting of 90% of the data and a testset consisting of 10%. Then we train our recommender using the training set and look how well it predicts the unknown interactions in the testset.

To test our recommender, we create a class called *EvaluateRecommender* with a main method and add an inner class called *MyRecommenderBuilder* that implements the *RecommenderBuilder* interface. We implement the *buildRecommender* method and make it setup our user-based recommender:

<pre>
UserSimilarity similarity = new PearsonCorrelationSimilarity(dataModel);
UserNeighborhood neighborhood = new ThresholdUserNeighborhood(0.1, similarity, dataModel);
return new GenericUserBasedRecommender(dataModel, neighborhood, similarity);
</pre>

Now we have to create the code for the test. We'll check how much the recommender misses the real interaction strength on average. We employ an *AverageAbsoluteDifferenceRecommenderEvaluator* for this. The following code shows how to put the pieces together and run a hold-out test: 

<pre>
DataModel model = new FileDataModel(new File("/path/to/dataset.csv"));
RecommenderEvaluator evaluator = new AverageAbsoluteDifferenceRecommenderEvaluator();
RecommenderBuilder builder = new MyRecommenderBuilder();
double result = evaluator.evaluate(builder, null, model, 0.9, 1.0);
System.out.println(result);
</pre>

Note: if you run this test multiple times, you will get different results, because the splitting into trainingset and testset is done randomly. 











</RecommendedItem></pre>


  <footer class="footer bg-light">
    <div class="container text-center small">
        Copyright &copy; 2014-2024 <a href="http://www.apache.org/">The Apache Software Foundation</a>, Licensed under the Apache License, Version 2.0.
    </div>
</footer>


  <script src="/assets/vendor/jquery/jquery-slim.min.js"></script>
  <script src="/assets/vendor/popper/popper.min.js"></script>
  <script src="/assets/vendor/bootstrap/js/bootstrap.min.js"></script>
  <script src="/assets/header.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

</body>

</html>
