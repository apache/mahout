<!DOCTYPE html>
<html lang=" en ">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
    Contributing new algorithms
    
  </title>

  <meta name="description" content="Distributed Linear Algebra">

  <link rel="stylesheet" href="/assets/css/main.css">

  <!-- Font Awesome -->
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Maven+Pro:400,500" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,700,700i" rel="stylesheet">

  <link rel="canonical" href="http://mahout.apache.org//documentation/tutorials/misc/contributing-algos/">
  <link rel="alternate" type="application/rss+xml" title="Apache Mahout" href="/feed.xml">


</head>


<body>

  <nav class="navbar navbar-expand-lg navbar-light bg-light navbar-mahout">

    <div class="container">

        <a class="navbar-brand" href="/">
            <img src="/assets/mahout-logo-blue.svg" alt="">
        </a>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            <div class="navbar-nav ml-auto">

                <!-- Quick Start -->
                <li class="nav-item">
                    <a class="nav-link" href="/docs/latest" >Overview</a>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Key Concepts</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item"  href="/docs/latest/index.html">Mahout Overview</a>
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">Scala DSL</h6>
                        <a class="dropdown-item"  href="/docs/latest/mahout-samsara/in-core-reference.html">In-core Reference</a>
                        <a class="dropdown-item"  href="/docs/latest/mahout-samsara/out-of-core-reference.html">Out-of-core Reference</a>
                        <a class="dropdown-item"  href="/docs/latest/mahout-samsara/faq.html">Samsara FAQ</a>
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">Distributed Engine Bindings</h6>
                        <a class="dropdown-item"  href="/docs/latest/distributed/spark-bindings/">Spark Bindings</a>
                        <a class="dropdown-item"  href="/docs/latest/distributed/flink-bindings.html">Flink Bindings</a>
                        <a class="dropdown-item"  href="/docs/latest/distributed/flink-bindings.html">H20 Bindings</a>
                        <!--<div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">Native Solvers</h6>
                        <a class="dropdown-item"  href="/docs/latest/native-solvers/viennacl.html">ViennaCL</a></li>
                        <a class="dropdown-item"  href="/docs/latest/native-solvers/viennacl-omp.html">ViennaCL-OMP</a></li>
                        <a class="dropdown-item"  href="/docs/latest/native-solvers/cuda.html">CUDA</a></li>-->
                    </div>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Tutorial</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">Recommenders</h6>
                        <a class="dropdown-item"  href="/docs/latest/tutorials/cco-lastfm">CCO Example with Last.FM Data</a>
                        <a class="dropdown-item"  href="/docs/latest/tutorials/intro-cooccurrence-spark">Introduction to Cooccurrence in Spark</a>
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">Mahout Samsara</h6>
                        <a class="dropdown-item"  href="/docs/latest/tutorials/samsara/play-with-shell.html">Playing with Samsara in Spark Shell</a>
                        <a class="dropdown-item"  href="/docs/latest/tutorials/samsara/playing-with-samsara-flink-batch.html">Playing with Samsara in Flink Batch</a>
                        <a class="dropdown-item"  href="/docs/latest/tutorials/samsara/classify-a-doc-from-the-shell.html">Text Classification (Shell)</a>
                        <a class="dropdown-item"  href="/docs/latest/tutorials/samsara/spark-naive-bayes.html">Spark Naive Bayes</a>
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">Misc</h6>
                        <a class="dropdown-item"  href="/docs/latest/tutorials/misc/getting-started-with-zeppelin">Mahout in Apache Zeppelin (Quickstart)</a>
<!--                        <a class="dropdown-item"  href="/docs/latest/tutorials/misc/mahout-in-zeppelin">Mahout in Apache Zeppelin (Roll your own)</a>-->
                        <a class="dropdown-item"  href="/docs/latest/tutorials/misc/contributing-algos">How To Contribute a New Algorithm</a>
                        <a class="dropdown-item"  href="/docs/latest/tutorials/misc/how-to-build-an-app.html">How To Build An App</a>
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">Deprecated</h6>
                        <a class="dropdown-item"  href="/docs/latest/tutorials/map-reduce">MapReduce</a>
                    </div>
                </li>


                <!-- Algorithms (Samsara / MR) -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Algorithms</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item"  href="/docs/latest/algorithms/linear-algebra">Distributed Linear Algebra</a>
                        <a class="dropdown-item"  href="/docs/latest/algorithms/preprocessors">Preprocessors</a>
                        <a class="dropdown-item"  href="/docs/latest/algorithms/regression">Regression</a>
                        <a class="dropdown-item"  href="/docs/latest/algorithms/clustering">Clustering</a>
                        <a class="dropdown-item"  href="/docs/latest/algorithms/recommenders">Recommenders</a>
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">Deprecated</h6>
                        <a class="dropdown-item"  href="/docs/latest/algorithms/map-reduce">MapReduce <i>(deprecated)</i></a>
                    </div>
                        <!--<a class="dropdown-item"  href="/docs/latest/algorithms/recommenders/recommender-overview.html">Reccomender Overview</a></li> Do we still need? seems like short version of next post-->
                        <!--
                        <a class="dropdown-item"  href="/docs/latest/algorithms/recommenders/intro-cooccurrence-spark.html">Intro to Coocurrence With Spark</a></li>
                        <li role="separator" class="divider"></li>
                        <li><span>&nbsp;&nbsp;<a href="/docs/latest/algorithms/map-reduce"><b>MapReduce</b> (deprecated)</a><span></li>


                     -->
                </li>

                <!-- Scala /docs -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">API /docs</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item"  href="/docs/0.13.0/api/docs/">0.13.0</a>
                    </div>
                </li>

                <!-- Apache -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Apache</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item"  href="http://www.apache.org/foundation/how-it-works.html">Apache Software Foundation</a>
                        <a class="dropdown-item"  href="http://www.apache.org/licenses/">Apache License</a>
                        <a class="dropdown-item"  href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
                        <a class="dropdown-item"  href="http://www.apache.org/foundation/thanks.html">Thanks</a>
                    </div>
                </li>

            </ul>

                <!--<form class="navbar-form navbar-left">-->
                    <!--<div class="form-group">-->
                        <!--<input type="text" class="form-control" placeholder="Search">-->
                    <!--</div>-->
                    <!--<button type="submit" class="btn btn-default">Submit</button>-->
                <!--</form>-->
                <!--<ul class="nav navbar-nav navbar-right">-->
                    <!--<a class="dropdown-item"  href="http://github.com/apache/mahout">Github</a></li>-->



                <!--</ul>-->
        </div><!-- /.navbar-collapse -->
    </div>
</nav>


  <div class="container mt-5 pb-4">

  <div class="row">

    <div class="col-lg-8">
      <p>The Mahout community is driven by user contribution.  If you have implemented an algorithm and are interested in 
sharing it with the rest of the community, we highly encourage you to contribute it to the codebase.  However to
keep things from getting too out of control, we have instituted a standard API for our algorithms, and we ask you 
contribute your algorithm in a way that conforms to this API as much as possible.  You can always reach out on 
<a href="dev@mahout.apache.org">dev@mahout.apache.org</a> if you need help.</p>

<p>In this example, let’s say you’ve created a totally new algorithm- a regression algorithm called <code class="language-plaintext highlighter-rouge">Foo</code></p>

<p>The <code class="language-plaintext highlighter-rouge">Foo</code> algorithm is a silly algorithm- it always guesses the target is 1. Not at all useful as an algorithm, but great for
illustrating how an algorithm would be added.</p>

<h2 id="step-1-create--jira-ticket">Step 1: Create  JIRA ticket</h2>

<p>Go to <a href="https://issues.apache.org/jira/browse/MAHOUT/">the Mahout JIRA board</a> and click the red “Create” button.</p>

<p>If you don’t see the button, you may need to be granted contributor rights on the JIRA board.  Send a message to <a href="dev@mahout.apache.org">dev@mahout.apache.org</a> and someone will add you.</p>

<p>Once you click “Create” a dialog box will pop up.</p>

<p>In the Summary box write a short description, something like <code class="language-plaintext highlighter-rouge">Implement Foo Algorithm</code></p>

<p>Under assignee- click “Assign to Me”, this lets everyone know you’re working on the algorithm.</p>

<p>In the description, it would be good to describe the algorithm, and if possible link to a Wikipedia article about the algorithm/method or better yet an academic journal article.</p>

<p><img src="new-jira.png" alt="Jira Dialogue box" /></p>

<p>Once you’ve creted- a JIRA number will be assigned.  For example, here is the JIRA ticket for me writing this tutorial.</p>

<p><img src="jira.png" alt="New Issue Created" /></p>

<p>This is MAHOUT-1980.  Whatever number your new issue is assigned, we’ll refer to as XXXX for the rest of the tutorial.</p>

<h2 id="step-2-clone-mahout-and-create-branch">Step 2. Clone Mahout and create branch</h2>

<p>Supposing you don’t already have a copy of Mahout on your computer open a terminal and type the following</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone http://github.com/apache/mahout
</code></pre></div></div>

<p>This will clone the Mahout source code into a directory called <code class="language-plaintext highlighter-rouge">mahout</code>.  Go into that directory and create a new branch called
<code class="language-plaintext highlighter-rouge">mahout-xxxx</code> (where <code class="language-plaintext highlighter-rouge">xxxx</code> is your JIRA number from step 1)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd mahout
git checkout -b mahout-xxxx
</code></pre></div></div>

<h2 id="step-3-create-classes-for-your-new-algorithm">Step 3. Create Classes for your new Algorithm</h2>

<p><strong>NOTE</strong> I am using IntelliJ Community-Edition as an IDE.  There are several good IDEs that exist, and I <em>highly</em> reccomend
you use one, but you can do what you like.  As far as screen shots go though, that is what I’m working with here.</p>

<p>Create a file <code class="language-plaintext highlighter-rouge">mahout/math-scala/src/main/scala/org/apache/mahout/math/algorithms/regression/FooModel.scala</code></p>

<p>The first thing to add to the file is a license:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/**
  * Licensed to the Apache Software Foundation (ASF) under one
  * or more contributor license agreements. See the NOTICE file
  * distributed with this work for additional information
  * regarding copyright ownership. The ASF licenses this file
  * to you under the Apache License, Version 2.0 (the
  * "License"); you may not use this file except in compliance
  * with the License. You may obtain a copy of the License at
  *
  * http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing,
  * software distributed under the License is distributed on an
  * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  * KIND, either express or implied. See the License for the
  * specific language governing permissions and limitations
  * under the License.
  */
</code></pre></div></div>

<p>The next thing to add to the file is the <code class="language-plaintext highlighter-rouge">package</code> statement.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>package org.apache.mahout.math.algorithms.regression
</code></pre></div></div>

<p>And finally declare the Fitter and Model classes</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Foo extends RegressorFitter {

}

class FooModel extends RegressorModel {

}
</code></pre></div></div>

<p>The Fitter class holds the methods for fitting which returns a Model, the Model class hold the parameters for the model and 
 methods for using on new data sets. In a RegressorModel that is going to be a <code class="language-plaintext highlighter-rouge">predict()</code> method.</p>

<p>In your algorithm, most of your code is going to go into the <code class="language-plaintext highlighter-rouge">.fit</code> method. Since this is just a silly example, we’re 
 don’t really have anything to fit- so we’re just going to return a FooModel (because that is what the Fitter must do)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Foo[K] extends RegressorFitter[K] {

  def fit(drmX  : DrmLike[K],
          drmTarget: DrmLike[K],
          hyperparameters: (Symbol, Any)*): FooModel[K] ={
    /**
      * Normally one would have a lot more code here.
      */

    var model = new FooModel[K]
    model.summary = "This model has been fit, I would tell you more interesting things- if there was anything to tell."
    model
  }
}

class FooModel[K] extends RegressorModel[K] {

  def predict(drmPredictors: DrmLike[K]): DrmLike[K] = {
    drmPredictors.mapBlock(1) {
      case (keys, block: Matrix) =&gt; {
        var outputBlock = new DenseMatrix(block.nrow, 1)
        keys -&gt; (outputBlock += 1.0)
      }
    }
  }
}
</code></pre></div></div>

<p>I’ve also added something to the summary string. It wasn’t a very helpful thing, but this isn’t a very helpful algorithm. I included
as a reminder to you, the person writing a useful algorithm, that this is a good place to talk about the results of the fitting.</p>

<p>At this point it would be reasonable to try building Mahout and checking that your algorithm is working the way you expect it to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvn clean package -DskipTests
</code></pre></div></div>

<p>I like to use the Mahout Spark-Shell for cases like this.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd $MAHOUT_HOME/bin
./mahout spark-shell
</code></pre></div></div>

<p>Then once I’m in the shell:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import org.apache.mahout.math.algorithms.regression.Foo

val drmA = drmParallelize(dense((1.0, 1.2, 1.3, 1.4), (1.1, 1.5, 2.5, 1.0), (6.0, 5.2, -5.2, 5.3), (7.0,6.0, 5.0, 5.0), (10.0, 1.0, 20.0, -10.0)))

val model = new Foo().fit(drmA(::, 0 until 2), drmA(::, 2 until 3))
 
model.predict(drmA).collect
</code></pre></div></div>

<p>And everything seems to be in order.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>res5: org.apache.mahout.math.Matrix =
{
 0 =&gt;   {0:1.0}
 1 =&gt;   {0:1.0}
 2 =&gt;   {0:1.0}
 3 =&gt;   {0:1.0}
 4 =&gt;   {0:1.0}
}
</code></pre></div></div>

<h2 id="step-4-working-with-hyper-parameters">Step 4. Working with Hyper Parameters</h2>

<p>It’s entirely likely you’ll need to have hyper-parameters to tune your algorithm.</p>

<p>In Mahout we handle these with a map of Symbols. You might have noticed in the <code class="language-plaintext highlighter-rouge">fit</code> and <code class="language-plaintext highlighter-rouge">predict</code> methods we included 
<code class="language-plaintext highlighter-rouge">hyperparameters: (Symbol, Any)*</code></p>

<p>Well let’s look at how we would work with those.</p>

<p>Suppose instead of always guessing “1.0” we wanted to guess some user defined number (a very silly algorithm).</p>

<p>We’ll be adding a parameter called <code class="language-plaintext highlighter-rouge">guessThisNumber</code> to the Fitter method. By convention, we usually create a function in 
the fitter called <code class="language-plaintext highlighter-rouge">setStandardHyperparameters</code> and let that take care of setting up all of our hyperparameters and then call
that function inside of fit. This keeps things nice and clean.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Foo[K] extends RegressorFitter[K] {

  var guessThisNumber: Double = _

  def setStandardHyperparameters(hyperparameters: Map[Symbol, Any] = Map('foo -&gt; None)): Unit = {
    guessThisNumber = hyperparameters.asInstanceOf[Map[Symbol, Double]].getOrElse('guessThisNumber, 1.0)
  }
  def fit(drmX  : DrmLike[K],
          drmTarget: DrmLike[K],
          hyperparameters: (Symbol, Any)*): FooModel[K] ={
    /**
      * Normally one would have a lot more code here.
      */

    var model = new FooModel[K]

    setStandardHyperparameters(hyperparameters.toMap)
    model.guessThisNumber = guessThisNumber
    model.summary = s"This model will always guess ${model.guessThisNumber}"
    model
  }
}
</code></pre></div></div>

<p>Also notice we set the <em>default value</em> to 1.0.  We also now have something to add into the summary string.</p>

<p>To implement this, we’ll need to broadcast the guessed number in the <code class="language-plaintext highlighter-rouge">predict</code> method.  In Mahout you can only broadcast
<code class="language-plaintext highlighter-rouge">Vectors</code> and <code class="language-plaintext highlighter-rouge">Matrices</code>.  We use <code class="language-plaintext highlighter-rouge">drmBroadcast</code> It might be tempting to use the broadcast method of the underlying engine, but 
this is a no-no.  The reason for this is that we want to keep our algorithm abstracted over multiple distributed engines.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class FooModel[K] extends RegressorModel[K] {

  var guessThisNumber: Double = _

  def predict(drmPredictors: DrmLike[K]): DrmLike[K] = {

    // This is needed for MapBlock
    implicit val ktag =  drmPredictors.keyClassTag

    // This is needed for broadcasting
    implicit val ctx = drmPredictors.context
    
    val bcGuess = drmBroadcast(dvec(guessThisNumber))
    drmPredictors.mapBlock(1) {
      case (keys, block: Matrix) =&gt; {
        var outputBlock = new DenseMatrix(block.nrow, 1)
        keys -&gt; (outputBlock += bcGuess.get(0))
      }
    }
  }
}
</code></pre></div></div>

<p>We can get pretty creative with what sort of information we can send out in the broadcast even when it’s just Vectors and Matrices</p>

<p>Here we get the single number we need by broadcasting it in a length 1 vector.  We then <code class="language-plaintext highlighter-rouge">get</code> our number from that position.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>keys -&gt; (outputBlock += bcGuess.get(0))
</code></pre></div></div>

<p>Let’s open up the <code class="language-plaintext highlighter-rouge">$MAHOUT_HOME/bin/mahout spark-shell</code> and try out the hyperparameter</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import org.apache.mahout.math.algorithms.regression.Foo
    
val drmA = drmParallelize(dense((1.0, 1.2, 1.3, 1.4), (1.1, 1.5, 2.5, 1.0), (6.0, 5.2, -5.2, 5.3), (7.0,6.0, 5.0, 5.0), (10.0, 1.0, 20.0, -10.0)))

val model = new Foo().fit(drmA(::, 0 until 2), drmA(::, 2 until 3), 'guessThisNumber -&gt; 2.0)
 
model.predict(drmA).collect
</code></pre></div></div>

<h2 id="step-5-unit-tests">Step 5. Unit Tests</h2>

<p>Ahh unit tests, so tedious but so important.  We want to create a unit test that will break if someone changes some other code
that causes our algorithm to fail (or guess the wrong numbers)</p>

<p>By convention, if an algorithm has been written in R it is best to make a very small sample data set, and run the R version
of the algorithm- and then verify your algorithm generates the same results, or explain why it there is divergence.</p>

<p>Since no one has implemented Foo in any other packages however, we will have to be very sure our algorithm correct by doing
it by hand in R, and in a way others can verify.  Actually- I’m not making a prototype of the Foo algorithm, but I do want to impress
that it <em>is</em> very important that you do, so that the person reviewing the PR can verify your results. (Maybe there is an example 
in the paper you read).</p>

<p>Since this is a regression model, open up</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$MAHOUT_HOME/math-scala/src/test/scala/org/apache/mahout/math/algorithms/RegressionSuiteBase.scala
</code></pre></div></div>

<p>You’ll see some other tests in there to get you started. You’ll also see some R-Prototypes, and in the case of <code class="language-plaintext highlighter-rouge">cochrane orcutt</code> 
where the R implementation had divergent results and my argument for why our algorithm was right.</p>

<p>I’m going to create a new test called <code class="language-plaintext highlighter-rouge">foo test</code> and I’m going to build it similar to the example I’ve been using.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>test("foo") {
    import org.apache.mahout.math.algorithms.regression.Foo

    val drmA = drmParallelize(dense((1.0, 1.2, 1.3, 1.4),
                                    (1.1, 1.5, 2.5, 1.0),
                                    (6.0, 5.2, -5.2, 5.3),
                                    (7.0,6.0, 5.0, 5.0),
                                    (10.0, 1.0, 20.0, -10.0)))

    val model = new Foo().fit(drmA(::, 0 until 2), drmA(::, 2 until 3), 'guessThisNumber -&gt; 2.0)

    val myAnswer = model.predict(drmA).collect
    val correctAnswer = dense( (2.0),
                                (2.0),
                                (2.0),
                                (2.0),
                                (2.0))


    val epsilon = 1E-6
    (myAnswer - correctAnswer).sum should be &lt; epsilon
  }
</code></pre></div></div>

<p>Note the use of <code class="language-plaintext highlighter-rouge">epsilon</code>.  The answer really <em>should be</em> 0.0. But, especially for more complicated algorithms, we allow 
for a touch of machine rounding error.</p>

<p>Now build and check your tests by building without skipping the tests</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvn clean package
</code></pre></div></div>

<h2 id="step-6-add-documentation-to-the-website">Step 6. Add documentation to the website.</h2>

<p>Now you’ve created this awesome algorithm- time to do a little marketing!  Create the following file:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$MAHOUT_HOME/website/docs/algorithms/regression/foo.md
</code></pre></div></div>

<p>In that file create a blank Jekyll template:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
layout: doc-page
title: Foo

    
---

### About

Foo is a very famous and useful algorithm. Let me tell you lots about it...

[A mark down link](https://en.wikipedia.org/wiki/Foobar)

### Parameters

&lt;div class="table-striped"&gt;
  &lt;table class="table"&gt;
    &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
        &lt;th&gt;Default Value&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;code&gt;'guessThisNumber&lt;/code&gt;&lt;/td&gt;
        &lt;td&gt;The number to guess&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;1.0&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;/table&gt;
    &lt;/div&gt;

### Example
import org.apache.mahout.math.algorithms.regression.Foo
        
val drmA = drmParallelize(dense((1.0, 1.2, 1.3, 1.4), (1.1, 1.5, 2.5, 1.0), (6.0, 5.2, -5.2, 5.3), (7.0,6.0, 5.0, 5.0), (10.0, 1.0, 20.0, -10.0)))

val model = new Foo().fit(drmA(::, 0 until 2), drmA(::, 2 until 3), 'guessThisNumber -&gt; 2.0)
 
model.predict(drmA).collect
</code></pre></div></div>

<p>The firse few lines between the <code class="language-plaintext highlighter-rouge">---</code> is the header, this has the title and tells Jekyll what sort of page this is, it knows 
elsewhere based on that, how to compile the page (add navbars, etc).</p>

<p>The <em>About</em> section, is your chance to really dive into the algorithm and its implementation. More is more. If you didn’t have an 
R prototype in the unit tests (or have a divergent answer from R) this is a good place to really expand on that.</p>

<p>The <em>Parameters</em> section is a good reference for users to know that the hyperparameters are and what they do.</p>

<p>The <em>Example</em> section is a quick little example to get users started. You may have noticed I used the same code I used in 
the unit test.  That’s something I do often, but there is no reason you have to. If you want to come up with a more illustrative example 
(or several illustrative examples) that’s encouraged.
Add links to the nav-bars</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$MAHOUT_HOME/website/docs/_includes/algo_navbar.html
$MAHOUT_HOME/website/docs/_includes/navbar.html
</code></pre></div></div>

<p>You can look at the links already in there, but it’s going to look something like</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;li&gt; &lt;a href="/algorithms/regression/Foo.html"&gt;Foo&lt;/a&gt;&lt;/li&gt;
</code></pre></div></div>

<p>Jeckyll will convert your *.md file into *.html at the same place on the directory tree.</p>

<p>To check that your webpage look right:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd $MAHOUT_HOME/website/docs
jeckyll --serve
</code></pre></div></div>

<p>Then open a webbrowser and go to <a href="http://localhost:4000">http://localhost:4000</a></p>

<p>If you’re feeling really froggy- you’re also welcome to add a tutorial :)</p>

<h2 id="step-7-commit-changes-push-to-github-and-open-a-pr">Step 7. Commit Changes, Push to Github, and Open a PR</h2>

<p>Open a terminal, return to the <code class="language-plaintext highlighter-rouge">mahout</code> top directory and type</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git status
</code></pre></div></div>

<p>You’ll see <code class="language-plaintext highlighter-rouge">Changes not staged for commit</code>.</p>

<p>Any file you touched will be listed there, but we only want to stage the files we were in.</p>

<p>For this tutorial it was</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add mahout/math-scala/src/main/scala/org/apache/mahout/math/algorithms/regression/FooModel.scala
git add math-scala/src/test/scala/org/apache/mahout/math/algorithms/RegressionSuiteBase.scala
git add website/docs/algorithms/regression/foo.md
git add website/docs/_includes/algo_navbar.html
git add website/docs/_includes/navbar.html
</code></pre></div></div>

<p>Now we <em>commit</em> our changes. We add a message that starts with <code class="language-plaintext highlighter-rouge">MAHOUT-xxxx</code> where <code class="language-plaintext highlighter-rouge">xxxx</code> is the JIRA number your issue was
assigned, then a descriptive title.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git commit -m "MAHOUT-xxxx Implement Foo Algorithm"
</code></pre></div></div>

<p>Finally, <em>push</em> the changes to your local repository. The <code class="language-plaintext highlighter-rouge">-u</code> flag will create a new branch</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git push -u origin mahout-xxxx
</code></pre></div></div>

<p>Now in your browser, go to <a href="http://github.com/yourusername/mahout">http://github.com/yourusername/mahout</a></p>

<p>There is a “branch” drop down menu- scroll down and find <code class="language-plaintext highlighter-rouge">mahout-xxxx</code></p>

<p><img src="github-branch.png" alt="i have lots of issues" /></p>

<p>Towards the top, off to the right, you’ll see a link to “Pull Request”, click on this- and follow the prompts!</p>

<p><img src="create-pr.png" alt="create PR" /></p>

<h2 id="conclusion">Conclusion</h2>

<p>That’s it!  Thanks so much for contributing to Apache Mahout, users like you are what keep this project moving forward!</p>

<p>I’ve included <a href="Foo.scala">Foo.scala</a> and <a href="RegressionSuiteBase.scala">RegressionSuiteBase.scala</a> for reference.</p>

    </div>


  </div>

</div>


  <footer class="footer bg-light">
    <div class="container text-center small">
        Copyright &copy; 2014-2024 <a href="http://www.apache.org/">The Apache Software Foundation</a>, Licensed under the Apache License, Version 2.0.
    </div>
</footer>


  <script src="/assets/vendor/jquery/jquery-slim.min.js"></script>
  <script src="/assets/vendor/popper/popper.min.js"></script>
  <script src="/assets/vendor/bootstrap/js/bootstrap.min.js"></script>
  <script src="/assets/header.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

</body>

</html>
